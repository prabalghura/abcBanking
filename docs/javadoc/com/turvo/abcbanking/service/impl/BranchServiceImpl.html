<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (1.8.0_151) on Tue Feb 27 17:29:00 IST 2018 -->
<title>BranchServiceImpl</title>
<meta name="date" content="2018-02-27">
<link rel="stylesheet" type="text/css" href="../../../../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../../../../script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="BranchServiceImpl";
        }
    }
    catch(err) {
    }
//-->
var methods = {"i0":10,"i1":10,"i2":10,"i3":10,"i4":10,"i5":10,"i6":10,"i7":10,"i8":10,"i9":10,"i10":10,"i11":10,"i12":10};
var tabs = {65535:["t0","All Methods"],2:["t2","Instance Methods"],8:["t4","Concrete Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/BranchServiceImpl.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../index-files/index-1.html">Index</a></li>
<li><a href="../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../../com/turvo/abcbanking/service/impl/BaseServiceImpl.html" title="class in com.turvo.abcbanking.service.impl"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../../../com/turvo/abcbanking/service/impl/BranchServiceImplTest.html" title="class in com.turvo.abcbanking.service.impl"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../index.html?com/turvo/abcbanking/service/impl/BranchServiceImpl.html" target="_top">Frames</a></li>
<li><a href="BranchServiceImpl.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">com.turvo.abcbanking.service.impl</div>
<h2 title="Class BranchServiceImpl" class="title">Class BranchServiceImpl</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li>java.lang.Object</li>
<li>
<ul class="inheritance">
<li><a href="../../../../../com/turvo/abcbanking/service/impl/BaseServiceImpl.html" title="class in com.turvo.abcbanking.service.impl">com.turvo.abcbanking.service.impl.BaseServiceImpl</a></li>
<li>
<ul class="inheritance">
<li>com.turvo.abcbanking.service.impl.BranchServiceImpl</li>
</ul>
</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<dl>
<dt>All Implemented Interfaces:</dt>
<dd><a href="../../../../../com/turvo/abcbanking/service/BranchService.html" title="interface in com.turvo.abcbanking.service">BranchService</a></dd>
</dl>
<hr>
<br>
<pre>@Service(value="branchService")
public class <span class="typeNameLabel">BranchServiceImpl</span>
extends <a href="../../../../../com/turvo/abcbanking/service/impl/BaseServiceImpl.html" title="class in com.turvo.abcbanking.service.impl">BaseServiceImpl</a>
implements <a href="../../../../../com/turvo/abcbanking/service/BranchService.html" title="interface in com.turvo.abcbanking.service">BranchService</a></pre>
<div class="block">Service implementation for Branch operations</div>
<dl>
<dt><span class="simpleTagLabel">Author:</span></dt>
<dd>Prabal Ghura</dd>
</dl>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- =========== FIELD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="field.summary">
<!--   -->
</a>
<h3>Field Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Field Summary table, listing fields, and an explanation">
<caption><span>Fields</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Field and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private java.util.concurrent.ConcurrentHashMap&lt;java.lang.Long,<a href="../../../../../com/turvo/abcbanking/model/Branch.html" title="class in com.turvo.abcbanking.model">Branch</a>&gt;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../com/turvo/abcbanking/service/impl/BranchServiceImpl.html#branches">branches</a></span></code>
<div class="block">Central JVM cache
 
 Because all autowired beans in Spring uses a singleton pattern
 wherever branch service is autowired the same instance will be available
 therefore maintaining a central cache of branches initially fetched from DB.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>(package private) <a href="../../../../../com/turvo/abcbanking/repository/BranchRepository.html" title="interface in com.turvo.abcbanking.repository">BranchRepository</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../com/turvo/abcbanking/service/impl/BranchServiceImpl.html#branchRepository">branchRepository</a></span></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>(package private) <a href="../../../../../com/turvo/abcbanking/service/CounterService.html" title="interface in com.turvo.abcbanking.service">CounterService</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../com/turvo/abcbanking/service/impl/BranchServiceImpl.html#counterService">counterService</a></span></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>(package private) <a href="../../../../../com/turvo/abcbanking/repository/ServiceRepository.html" title="interface in com.turvo.abcbanking.repository">ServiceRepository</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../com/turvo/abcbanking/service/impl/BranchServiceImpl.html#serviceRepository">serviceRepository</a></span></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>(package private) <a href="../../../../../com/turvo/abcbanking/repository/TokenRepository.html" title="interface in com.turvo.abcbanking.repository">TokenRepository</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../com/turvo/abcbanking/service/impl/BranchServiceImpl.html#tokenRepository">tokenRepository</a></span></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>(package private) <a href="../../../../../com/turvo/abcbanking/service/UserService.html" title="interface in com.turvo.abcbanking.service">UserService</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../com/turvo/abcbanking/service/impl/BranchServiceImpl.html#userService">userService</a></span></code>&nbsp;</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="fields.inherited.from.class.com.turvo.abcbanking.service.impl.BaseServiceImpl">
<!--   -->
</a>
<h3>Fields inherited from class&nbsp;com.turvo.abcbanking.service.impl.<a href="../../../../../com/turvo/abcbanking/service/impl/BaseServiceImpl.html" title="class in com.turvo.abcbanking.service.impl">BaseServiceImpl</a></h3>
<code><a href="../../../../../com/turvo/abcbanking/service/impl/BaseServiceImpl.html#roleService">roleService</a></code></li>
</ul>
</li>
</ul>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colOne" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colOne"><code><span class="memberNameLink"><a href="../../../../../com/turvo/abcbanking/service/impl/BranchServiceImpl.html#BranchServiceImpl--">BranchServiceImpl</a></span>()</code>&nbsp;</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t2" class="tableTab"><span><a href="javascript:show(2);">Instance Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t4" class="tableTab"><span><a href="javascript:show(8);">Concrete Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code><a href="../../../../../com/turvo/abcbanking/model/Branch.html" title="class in com.turvo.abcbanking.model">Branch</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../com/turvo/abcbanking/service/impl/BranchServiceImpl.html#assignManager-java.lang.String-java.lang.Long-java.lang.String-">assignManager</a></span>(java.lang.String&nbsp;assignerId,
             java.lang.Long&nbsp;branchId,
             java.lang.String&nbsp;managerId)</code>
<div class="block">Access check is performed
 Inputs are system validated
 Branch is updated in DB and instance is updated in cache synchronously</div>
</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code><a href="../../../../../com/turvo/abcbanking/model/Branch.html" title="class in com.turvo.abcbanking.model">Branch</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../com/turvo/abcbanking/service/impl/BranchServiceImpl.html#createNewBranch-java.lang.String-com.turvo.abcbanking.model.Branch-">createNewBranch</a></span>(java.lang.String&nbsp;creatorId,
               <a href="../../../../../com/turvo/abcbanking/model/Branch.html" title="class in com.turvo.abcbanking.model">Branch</a>&nbsp;branch)</code>
<div class="block">Access check is performed
 Passed branch object is validated
 Branch is pushed to DB and instance is created in cache synchronously</div>
</td>
</tr>
<tr id="i2" class="altColor">
<td class="colFirst"><code>java.util.List&lt;<a href="../../../../../com/turvo/abcbanking/model/Branch.html" title="class in com.turvo.abcbanking.model">Branch</a>&gt;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../com/turvo/abcbanking/service/impl/BranchServiceImpl.html#getAllBranches--">getAllBranches</a></span>()</code>
<div class="block">If branch cache is empty then it is fetched from DB
 This task is ran post system build for initial heavy lifting as well</div>
</td>
</tr>
<tr id="i3" class="rowColor">
<td class="colFirst"><code><a href="../../../../../com/turvo/abcbanking/model/Counter.html" title="class in com.turvo.abcbanking.model">Counter</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../com/turvo/abcbanking/service/impl/BranchServiceImpl.html#getBestCounter-java.lang.Long-com.turvo.abcbanking.model.CustomerType-java.lang.Long-">getBestCounter</a></span>(java.lang.Long&nbsp;branchId,
              <a href="../../../../../com/turvo/abcbanking/model/CustomerType.html" title="enum in com.turvo.abcbanking.model">CustomerType</a>&nbsp;type,
              java.lang.Long&nbsp;stepId)</code>
<div class="block">All the counters within a branch serving passed customer type are short-listed.</div>
</td>
</tr>
<tr id="i4" class="altColor">
<td class="colFirst"><code><a href="../../../../../com/turvo/abcbanking/model/Branch.html" title="class in com.turvo.abcbanking.model">Branch</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../com/turvo/abcbanking/service/impl/BranchServiceImpl.html#getBranch-java.lang.Long-">getBranch</a></span>(java.lang.Long&nbsp;id)</code>
<div class="block">id is passed as key to map and instance is returned</div>
</td>
</tr>
<tr id="i5" class="rowColor">
<td class="colFirst"><code>private java.util.List&lt;<a href="../../../../../com/turvo/abcbanking/model/Branch.html" title="class in com.turvo.abcbanking.model">Branch</a>&gt;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../com/turvo/abcbanking/service/impl/BranchServiceImpl.html#getBranchesFromDB--">getBranchesFromDB</a></span>()</code>
<div class="block">For full cache load</div>
</td>
</tr>
<tr id="i6" class="altColor">
<td class="colFirst"><code>private <a href="../../../../../com/turvo/abcbanking/model/Branch.html" title="class in com.turvo.abcbanking.model">Branch</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../com/turvo/abcbanking/service/impl/BranchServiceImpl.html#getBranchFull-com.turvo.abcbanking.model.Branch-">getBranchFull</a></span>(<a href="../../../../../com/turvo/abcbanking/model/Branch.html" title="class in com.turvo.abcbanking.model">Branch</a>&nbsp;branch)</code>
<div class="block">To get full fledged branch with all its containing objects
 Heavy operation but called sparingly
 
 services are fetched
 counters are fetched
 branch token generator base value is fetched</div>
</td>
</tr>
<tr id="i7" class="rowColor">
<td class="colFirst"><code>private java.util.List&lt;<a href="../../../../../com/turvo/abcbanking/model/Service.html" title="class in com.turvo.abcbanking.model">Service</a>&gt;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../com/turvo/abcbanking/service/impl/BranchServiceImpl.html#getServicesFromDB-java.lang.Long-com.turvo.abcbanking.model.CustomerType-">getServicesFromDB</a></span>(java.lang.Long&nbsp;branchId,
                 <a href="../../../../../com/turvo/abcbanking/model/CustomerType.html" title="enum in com.turvo.abcbanking.model">CustomerType</a>&nbsp;type)</code>
<div class="block">For service + service step load for a branch and customer type</div>
</td>
</tr>
<tr id="i8" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../com/turvo/abcbanking/service/impl/BranchServiceImpl.html#reloadEntireCache--">reloadEntireCache</a></span>()</code>
<div class="block">cache is cleared and initial startup operation is called</div>
</td>
</tr>
<tr id="i9" class="rowColor">
<td class="colFirst"><code>private <a href="../../../../../com/turvo/abcbanking/model/Branch.html" title="class in com.turvo.abcbanking.model">Branch</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../com/turvo/abcbanking/service/impl/BranchServiceImpl.html#updateBranch-com.turvo.abcbanking.model.Branch-">updateBranch</a></span>(<a href="../../../../../com/turvo/abcbanking/model/Branch.html" title="class in com.turvo.abcbanking.model">Branch</a>&nbsp;branch)</code>
<div class="block">updates a branch in the cache</div>
</td>
</tr>
<tr id="i10" class="altColor">
<td class="colFirst"><code>private <a href="../../../../../com/turvo/abcbanking/model/Branch.html" title="class in com.turvo.abcbanking.model">Branch</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../com/turvo/abcbanking/service/impl/BranchServiceImpl.html#updateBranch-java.lang.Long-">updateBranch</a></span>(java.lang.Long&nbsp;branchId)</code>
<div class="block">updates a branch in the cache by fetching it from DB synchronously
 Branch is immediately removed from cache so that all operations fail till it is fetched from DB
 it's like making branch and its entire children unavailable till it is ready again.</div>
</td>
</tr>
<tr id="i11" class="rowColor">
<td class="colFirst"><code><a href="../../../../../com/turvo/abcbanking/model/Branch.html" title="class in com.turvo.abcbanking.model">Branch</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../com/turvo/abcbanking/service/impl/BranchServiceImpl.html#updateBranch-java.lang.String-java.lang.Long-">updateBranch</a></span>(java.lang.String&nbsp;managerId,
            java.lang.Long&nbsp;branchId)</code>
<div class="block">Access check is performed for branch manager
 Single Branch instance is fetched from DB</div>
</td>
</tr>
<tr id="i12" class="altColor">
<td class="colFirst"><code><a href="../../../../../com/turvo/abcbanking/model/Counter.html" title="class in com.turvo.abcbanking.model">Counter</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../com/turvo/abcbanking/service/impl/BranchServiceImpl.html#updateCounter-com.turvo.abcbanking.model.Counter-">updateCounter</a></span>(<a href="../../../../../com/turvo/abcbanking/model/Counter.html" title="class in com.turvo.abcbanking.model">Counter</a>&nbsp;counter)</code>
<div class="block">parent branch is fetched for a counter 
 branch's counter map is updated
 and entire branch object is updated in JVM cache</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods.inherited.from.class.com.turvo.abcbanking.service.impl.BaseServiceImpl">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;com.turvo.abcbanking.service.impl.<a href="../../../../../com/turvo/abcbanking/service/impl/BaseServiceImpl.html" title="class in com.turvo.abcbanking.service.impl">BaseServiceImpl</a></h3>
<code><a href="../../../../../com/turvo/abcbanking/service/impl/BaseServiceImpl.html#checkAccess-java.lang.String-java.lang.String-">checkAccess</a></code></li>
</ul>
<ul class="blockList">
<li class="blockList"><a name="methods.inherited.from.class.java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.Object</h3>
<code>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ FIELD DETAIL =========== -->
<ul class="blockList">
<li class="blockList"><a name="field.detail">
<!--   -->
</a>
<h3>Field Detail</h3>
<a name="branches">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>branches</h4>
<pre>private&nbsp;java.util.concurrent.ConcurrentHashMap&lt;java.lang.Long,<a href="../../../../../com/turvo/abcbanking/model/Branch.html" title="class in com.turvo.abcbanking.model">Branch</a>&gt; branches</pre>
<div class="block">Central JVM cache
 
 Because all autowired beans in Spring uses a singleton pattern
 wherever branch service is autowired the same instance will be available
 therefore maintaining a central cache of branches initially fetched from DB.
 Whatever be the changes will be published to DB possibly asynchronously and 
 immediately updated in JVM cache (least possible granular level) 
 in thread safe manner for fast access.</div>
</li>
</ul>
<a name="branchRepository">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>branchRepository</h4>
<pre>@Autowired
<a href="../../../../../com/turvo/abcbanking/repository/BranchRepository.html" title="interface in com.turvo.abcbanking.repository">BranchRepository</a> branchRepository</pre>
</li>
</ul>
<a name="counterService">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>counterService</h4>
<pre>@Autowired
<a href="../../../../../com/turvo/abcbanking/service/CounterService.html" title="interface in com.turvo.abcbanking.service">CounterService</a> counterService</pre>
</li>
</ul>
<a name="userService">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>userService</h4>
<pre>@Autowired
<a href="../../../../../com/turvo/abcbanking/service/UserService.html" title="interface in com.turvo.abcbanking.service">UserService</a> userService</pre>
</li>
</ul>
<a name="serviceRepository">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>serviceRepository</h4>
<pre>@Autowired
<a href="../../../../../com/turvo/abcbanking/repository/ServiceRepository.html" title="interface in com.turvo.abcbanking.repository">ServiceRepository</a> serviceRepository</pre>
</li>
</ul>
<a name="tokenRepository">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>tokenRepository</h4>
<pre>@Autowired
<a href="../../../../../com/turvo/abcbanking/repository/TokenRepository.html" title="interface in com.turvo.abcbanking.repository">TokenRepository</a> tokenRepository</pre>
</li>
</ul>
</li>
</ul>
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="BranchServiceImpl--">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>BranchServiceImpl</h4>
<pre>public&nbsp;BranchServiceImpl()</pre>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="getAllBranches--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getAllBranches</h4>
<pre>public&nbsp;java.util.List&lt;<a href="../../../../../com/turvo/abcbanking/model/Branch.html" title="class in com.turvo.abcbanking.model">Branch</a>&gt;&nbsp;getAllBranches()</pre>
<div class="block">If branch cache is empty then it is fetched from DB
 This task is ran post system build for initial heavy lifting as well</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="../../../../../com/turvo/abcbanking/service/BranchService.html#getAllBranches--">getAllBranches</a></code>&nbsp;in interface&nbsp;<code><a href="../../../../../com/turvo/abcbanking/service/BranchService.html" title="interface in com.turvo.abcbanking.service">BranchService</a></code></dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>List of branches made by traversing the cache</dd>
</dl>
</li>
</ul>
<a name="getBranch-java.lang.Long-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getBranch</h4>
<pre>public&nbsp;<a href="../../../../../com/turvo/abcbanking/model/Branch.html" title="class in com.turvo.abcbanking.model">Branch</a>&nbsp;getBranch(java.lang.Long&nbsp;id)</pre>
<div class="block">id is passed as key to map and instance is returned</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="../../../../../com/turvo/abcbanking/service/BranchService.html#getBranch-java.lang.Long-">getBranch</a></code>&nbsp;in interface&nbsp;<code><a href="../../../../../com/turvo/abcbanking/service/BranchService.html" title="interface in com.turvo.abcbanking.service">BranchService</a></code></dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>branch instance if exists null otherwise</dd>
</dl>
</li>
</ul>
<a name="createNewBranch-java.lang.String-com.turvo.abcbanking.model.Branch-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>createNewBranch</h4>
<pre>@Transactional(readOnly=false)
public&nbsp;<a href="../../../../../com/turvo/abcbanking/model/Branch.html" title="class in com.turvo.abcbanking.model">Branch</a>&nbsp;createNewBranch(java.lang.String&nbsp;creatorId,
                                                             <a href="../../../../../com/turvo/abcbanking/model/Branch.html" title="class in com.turvo.abcbanking.model">Branch</a>&nbsp;branch)</pre>
<div class="block">Access check is performed
 Passed branch object is validated
 Branch is pushed to DB and instance is created in cache synchronously</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="../../../../../com/turvo/abcbanking/service/BranchService.html#createNewBranch-java.lang.String-com.turvo.abcbanking.model.Branch-">createNewBranch</a></code>&nbsp;in interface&nbsp;<code><a href="../../../../../com/turvo/abcbanking/service/BranchService.html" title="interface in com.turvo.abcbanking.service">BranchService</a></code></dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>new branch instance</dd>
</dl>
</li>
</ul>
<a name="assignManager-java.lang.String-java.lang.Long-java.lang.String-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>assignManager</h4>
<pre>@Transactional(readOnly=false)
public&nbsp;<a href="../../../../../com/turvo/abcbanking/model/Branch.html" title="class in com.turvo.abcbanking.model">Branch</a>&nbsp;assignManager(java.lang.String&nbsp;assignerId,
                                                           java.lang.Long&nbsp;branchId,
                                                           java.lang.String&nbsp;managerId)</pre>
<div class="block">Access check is performed
 Inputs are system validated
 Branch is updated in DB and instance is updated in cache synchronously</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="../../../../../com/turvo/abcbanking/service/BranchService.html#assignManager-java.lang.String-java.lang.Long-java.lang.String-">assignManager</a></code>&nbsp;in interface&nbsp;<code><a href="../../../../../com/turvo/abcbanking/service/BranchService.html" title="interface in com.turvo.abcbanking.service">BranchService</a></code></dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>updated branch instance</dd>
</dl>
</li>
</ul>
<a name="updateBranch-java.lang.String-java.lang.Long-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>updateBranch</h4>
<pre>public&nbsp;<a href="../../../../../com/turvo/abcbanking/model/Branch.html" title="class in com.turvo.abcbanking.model">Branch</a>&nbsp;updateBranch(java.lang.String&nbsp;managerId,
                           java.lang.Long&nbsp;branchId)</pre>
<div class="block">Access check is performed for branch manager
 Single Branch instance is fetched from DB</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="../../../../../com/turvo/abcbanking/service/BranchService.html#updateBranch-java.lang.String-java.lang.Long-">updateBranch</a></code>&nbsp;in interface&nbsp;<code><a href="../../../../../com/turvo/abcbanking/service/BranchService.html" title="interface in com.turvo.abcbanking.service">BranchService</a></code></dd>
<dt><span class="returnLabel">Returns:</span></dt>
</dl>
</li>
</ul>
<a name="updateCounter-com.turvo.abcbanking.model.Counter-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>updateCounter</h4>
<pre>public&nbsp;<a href="../../../../../com/turvo/abcbanking/model/Counter.html" title="class in com.turvo.abcbanking.model">Counter</a>&nbsp;updateCounter(<a href="../../../../../com/turvo/abcbanking/model/Counter.html" title="class in com.turvo.abcbanking.model">Counter</a>&nbsp;counter)</pre>
<div class="block">parent branch is fetched for a counter 
 branch's counter map is updated
 and entire branch object is updated in JVM cache</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="../../../../../com/turvo/abcbanking/service/BranchService.html#updateCounter-com.turvo.abcbanking.model.Counter-">updateCounter</a></code>&nbsp;in interface&nbsp;<code><a href="../../../../../com/turvo/abcbanking/service/BranchService.html" title="interface in com.turvo.abcbanking.service">BranchService</a></code></dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>updated counter instance</dd>
</dl>
</li>
</ul>
<a name="getBestCounter-java.lang.Long-com.turvo.abcbanking.model.CustomerType-java.lang.Long-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getBestCounter</h4>
<pre>public&nbsp;<a href="../../../../../com/turvo/abcbanking/model/Counter.html" title="class in com.turvo.abcbanking.model">Counter</a>&nbsp;getBestCounter(java.lang.Long&nbsp;branchId,
                              <a href="../../../../../com/turvo/abcbanking/model/CustomerType.html" title="enum in com.turvo.abcbanking.model">CustomerType</a>&nbsp;type,
                              java.lang.Long&nbsp;stepId)</pre>
<div class="block">All the counters within a branch serving passed customer type are short-listed. 
 Counters which are not serving passed service_step are removed from the list. 
 From the remaining list counter with least token queue size is returned</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="../../../../../com/turvo/abcbanking/service/BranchService.html#getBestCounter-java.lang.Long-com.turvo.abcbanking.model.CustomerType-java.lang.Long-">getBestCounter</a></code>&nbsp;in interface&nbsp;<code><a href="../../../../../com/turvo/abcbanking/service/BranchService.html" title="interface in com.turvo.abcbanking.service">BranchService</a></code></dd>
<dt><span class="returnLabel">Returns:</span></dt>
</dl>
</li>
</ul>
<a name="reloadEntireCache--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>reloadEntireCache</h4>
<pre>public&nbsp;void&nbsp;reloadEntireCache()</pre>
<div class="block">cache is cleared and initial startup operation is called</div>
<dl>
<dt><span class="overrideSpecifyLabel">Specified by:</span></dt>
<dd><code><a href="../../../../../com/turvo/abcbanking/service/BranchService.html#reloadEntireCache--">reloadEntireCache</a></code>&nbsp;in interface&nbsp;<code><a href="../../../../../com/turvo/abcbanking/service/BranchService.html" title="interface in com.turvo.abcbanking.service">BranchService</a></code></dd>
</dl>
</li>
</ul>
<a name="updateBranch-com.turvo.abcbanking.model.Branch-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>updateBranch</h4>
<pre>private&nbsp;<a href="../../../../../com/turvo/abcbanking/model/Branch.html" title="class in com.turvo.abcbanking.model">Branch</a>&nbsp;updateBranch(<a href="../../../../../com/turvo/abcbanking/model/Branch.html" title="class in com.turvo.abcbanking.model">Branch</a>&nbsp;branch)</pre>
<div class="block">updates a branch in the cache</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>branch</code> - </dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>updated Branch instance</dd>
</dl>
</li>
</ul>
<a name="updateBranch-java.lang.Long-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>updateBranch</h4>
<pre>private&nbsp;<a href="../../../../../com/turvo/abcbanking/model/Branch.html" title="class in com.turvo.abcbanking.model">Branch</a>&nbsp;updateBranch(java.lang.Long&nbsp;branchId)</pre>
<div class="block">updates a branch in the cache by fetching it from DB synchronously
 Branch is immediately removed from cache so that all operations fail till it is fetched from DB
 it's like making branch and its entire children unavailable till it is ready again.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>branchId</code> - </dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>updated Branch instance</dd>
</dl>
</li>
</ul>
<a name="getBranchesFromDB--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getBranchesFromDB</h4>
<pre>private&nbsp;java.util.List&lt;<a href="../../../../../com/turvo/abcbanking/model/Branch.html" title="class in com.turvo.abcbanking.model">Branch</a>&gt;&nbsp;getBranchesFromDB()</pre>
<div class="block">For full cache load</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>list of branches</dd>
</dl>
</li>
</ul>
<a name="getBranchFull-com.turvo.abcbanking.model.Branch-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getBranchFull</h4>
<pre>private&nbsp;<a href="../../../../../com/turvo/abcbanking/model/Branch.html" title="class in com.turvo.abcbanking.model">Branch</a>&nbsp;getBranchFull(<a href="../../../../../com/turvo/abcbanking/model/Branch.html" title="class in com.turvo.abcbanking.model">Branch</a>&nbsp;branch)</pre>
<div class="block">To get full fledged branch with all its containing objects
 Heavy operation but called sparingly
 
 services are fetched
 counters are fetched
 branch token generator base value is fetched</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>branch</code> - </dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>full branch instance</dd>
</dl>
</li>
</ul>
<a name="getServicesFromDB-java.lang.Long-com.turvo.abcbanking.model.CustomerType-">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>getServicesFromDB</h4>
<pre>private&nbsp;java.util.List&lt;<a href="../../../../../com/turvo/abcbanking/model/Service.html" title="class in com.turvo.abcbanking.model">Service</a>&gt;&nbsp;getServicesFromDB(java.lang.Long&nbsp;branchId,
                                                  <a href="../../../../../com/turvo/abcbanking/model/CustomerType.html" title="enum in com.turvo.abcbanking.model">CustomerType</a>&nbsp;type)</pre>
<div class="block">For service + service step load for a branch and customer type</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>branchId</code> - </dd>
<dd><code>type</code> - </dd>
<dt><span class="returnLabel">Returns:</span></dt>
</dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/BranchServiceImpl.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../index-files/index-1.html">Index</a></li>
<li><a href="../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../../com/turvo/abcbanking/service/impl/BaseServiceImpl.html" title="class in com.turvo.abcbanking.service.impl"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../../../com/turvo/abcbanking/service/impl/BranchServiceImplTest.html" title="class in com.turvo.abcbanking.service.impl"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../index.html?com/turvo/abcbanking/service/impl/BranchServiceImpl.html" target="_top">Frames</a></li>
<li><a href="BranchServiceImpl.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>
